tests:
  - {input: 'a', result: 'a'}
  #- () -> error
  - {input: '(a)', result: 'a'}
  - {input: '( ( a ) )', result: 'a'}
  - {input: 'a|b', result: [any, {of: ['a', 'b']}]}
  - {input: 'a|(b)', result: [any, {of: ['a', 'b']}]}
  - {input: 'a | b', result: [any, {of: ['a', 'b']}]}
  - {input: 'a|b|c|d', result: [any, {of: ['a', 'b', 'c', 'd']}]}
  - {input: 'a&b', result: [all, {of: ['a', 'b']}]}
  - {input: 'a&(b)', result: [all, {of: ['a', 'b']}]}
  - {input: 'a & b', result: [all, {of: ['a', 'b']}]}
  - {input: 'a&b&c&d', result: [all, {of: ['a', 'b', 'c', 'd']}]}
  - {input: 'a*', result: [a, {req: Yes}]}
  - {input: '(a)*', result: [a, {req: Yes}]}
  - {input: '(a|b)*', result: [any, {of: ['a', 'b'], req: Yes}]}

  #- [] -> error
  - {input: 'a[]', result: [array, {of: 'a'}]}
  - {input: 'a[][]', result: [array, {of: [array, {of: 'a'}]}]}
  - {input: '(a*)[]', result: [array, {of: [a, {req: Yes}]}]}
  - {input: 'a*[]', result: [array, {of: [a, {req: Yes}]}]}
  - {input: '((int*)[])*', result: [array, {of: [int, {req: Yes}], req: Yes}]}
  - {input: 'int*[]*', result: [array, {of: [int, {req: Yes}], req: Yes}]}
  - {input: 'a*|b*', result: [any, {of: [[a, {req: Yes}], [b, {req: Yes}]]}]}
  - {input: '(a*|b*)*', result: [any, {of: [[a, {req: Yes}], [b, {req: Yes}]], req: Yes}]}
  - {input: 'a[]&b[]', result: [all, {of: [[array, {of: 'a'}], [array, {of: 'b'}]]}]}
  - {input: '(a|b)[]', result: [array, {of: [any, {of: ['a', 'b']}]}]}
  - {input: '((a|b)*)[]', result: [array, {of: [any, {of: ['a', 'b'], req: Yes}]}]}
  - {input: '(a|b)*[]', result: [array, {of: [any, {of: ['a', 'b'], req: Yes}]}]}
  - {input: 'a[1]', result: [array, {of: 'a', len: 1}]}
  - {input: 'a[2-]', result: [array, {of: 'a', min_len: 2}]}
  - {input: 'a[-3]', result: [array, {of: 'a', max_len: 3}]}
  - {input: 'a[4-5]', result: [array, {of: 'a', min_len: 4, max_len: 5}]}

  - {input: '[a,b]', result: [array, {elems: ['a', 'b']}]}
  - {input: '[a*,(b|c)]', result: [array, {elems: [[a, {req: Yes}], [any, {of: ['b', 'c']}]]}]}
  - {input: '[a*,b*,c*]*', result: [array, {elems: [[a, {req: Yes}], [b, {req: Yes}], [c, {req: Yes}]], req: Yes}]}
  - {input: '([a*,b*,c*])*', result: [array, {elems: [[a, {req: Yes}], [b, {req: Yes}], [c, {req: Yes}]], req: Yes}]}
  - {input: '[a*, b*, c*][]', result: [array, {of: [array, {elems: [[a, {req: Yes}], [b, {req: Yes}], [c, {req: Yes}]]}]}]}
  - {input: '([a*,b*,c*]*)[]', result: [array, {of: [array, {elems: [[a, {req: Yes}], [b, {req: Yes}], [c, {req: Yes}]], req: Yes}]}]}

  #- {} -> error
  - {input: '{k1 => int}', result: [hash, {keys: {k1: int}}]}
  - {input: '{k1 => int}', result: [hash, {keys: {k1: 'int'}}]}
  - {input: '{k1 => int}*', result: [hash, {keys: {k1: 'int'}, req: Yes}]}
  - {input: '{k1 => int*}', result: [hash, {keys: {k1: [int, {req: Yes}]}}]}
  - {input: '{* => str}', result: [hash, {values_of: 'str'}]}
  - {input: '{k1 => int, k2 => str[], k3 => (int*|float*)}', result: [hash, {keys: {k1: 'int', k2: [array, {of: 'str'}], k3: [any, {of: [[int, {req: Yes}], [float, {req: Yes}]]}]}}]}
